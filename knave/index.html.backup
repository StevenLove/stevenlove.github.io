<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Activity</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
    </style>
</head>
<body>
    <h1>Random Activity Generator</h1>
    <button id="generate">Generate Activity</button>
    <!-- <p id="activity"></p> -->
    <table id="data-table">
        <thead>
            <tr>
                <th>Short String</th>
                <th>Number</th>
                <th>Long String</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <script>

        /**
 
        
         
         */


        function addRow(shortStr, number, longStr) {
            const tableBody = document.querySelector("#data-table tbody");
            const newRow = document.createElement("tr");

            const shortStrCell = document.createElement("td");
            shortStrCell.textContent = shortStr;
            newRow.appendChild(shortStrCell);

            const numberCell = document.createElement("td");
            numberCell.textContent = number;
            newRow.appendChild(numberCell);

            const longStrCell = document.createElement("td");
            longStrCell.textContent = longStr;
            newRow.appendChild(longStrCell);

            tableBody.appendChild(newRow);
        }

        const names = `
            Activities
            Careers
            Delve Shifts
            Dungeons
            Hazards
            Locations
            Mechanisms
            Place Traits
            Qualities
            Room Details
            Room Themes
            Rooms
            Signs
            Spells
            Structures
            Trap Effects
            Travel shifts
            Wizard Names
        `.trim().split("\n").map(t=>t.trim());
        const MAX_NAME_LENGTH = Math.max(...names.map(t=>t.length));

        const results = {};

        
        async function load(){
            let promises = names.map(name=>fetchFile(name));
            await Promise.all(promises);
            displayRandomActivity();


            
        }



        async function fetchFile(name){
            const path = `./working/${name}.txt`;
            const text = await (await fetch(path)).text();
            let result = text.split("\n").map(t=>t.trim()).filter(t=>t);
            results[name] = result;
        }

        function getRandomInt(max) {
            return Math.floor(Math.random() * max);
        }

        async function displayRandomActivity() {
            // clear the table
            document.getElementById('data-table').querySelector('tbody').innerHTML = '';

            names.forEach(name=>{
                const randomIndex = getRandomInt(100)
                const randomResult = results[name][randomIndex];
                addRow(name,randomIndex,randomResult);
            })
        }

        document.getElementById('generate').addEventListener('click', displayRandomActivity);
        document.onreadystatechange = load;
    </script>
</body>
</html>
